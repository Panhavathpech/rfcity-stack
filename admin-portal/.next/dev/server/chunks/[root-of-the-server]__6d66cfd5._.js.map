{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///Users/macbookpro/Documents/Personal%20Works/Vibe%20Coding/Antigravity/R%26F%20City/admin-portal/src/lib/env.ts"],"sourcesContent":["import { z } from \"zod\";\n\nconst envSchema = z.object({\n  INSTANT_APP_ID: z.string().min(1, \"INSTANT_APP_ID is required\"),\n  INSTANT_ADMIN_TOKEN: z.string().min(1, \"INSTANT_ADMIN_TOKEN is required\"),\n  RESEND_API_KEY: z.string().min(1, \"RESEND_API_KEY is required\"),\n  CONTACT_ALERT_RECIPIENT: z\n    .string()\n    .email(\"CONTACT_ALERT_RECIPIENT must be a valid email\"),\n  SUPPORT_FROM_EMAIL: z\n    .string()\n    .email(\"SUPPORT_FROM_EMAIL must be a valid email\"),\n  NEXTAUTH_SECRET: z.string().min(1, \"NEXTAUTH_SECRET is required\"),\n  NEXTAUTH_URL: z.string().optional(),\n  PASSWORD_PEPPER: z.string().min(1, \"PASSWORD_PEPPER is required\"),\n  CONTACT_ALLOWED_ORIGIN: z.string().default(\"*\"),\n  SITE_BASE_URL: z\n    .string()\n    .url(\"SITE_BASE_URL must be a valid URL\")\n    .default(\"http://localhost:3000\"),\n});\n\ntype Env = z.infer<typeof envSchema>;\n\nexport const env: Env = envSchema.parse({\n  INSTANT_APP_ID: process.env.INSTANT_APP_ID,\n  INSTANT_ADMIN_TOKEN: process.env.INSTANT_ADMIN_TOKEN,\n  RESEND_API_KEY: process.env.RESEND_API_KEY,\n  CONTACT_ALERT_RECIPIENT: process.env.CONTACT_ALERT_RECIPIENT,\n  SUPPORT_FROM_EMAIL: process.env.SUPPORT_FROM_EMAIL,\n  NEXTAUTH_SECRET: process.env.NEXTAUTH_SECRET,\n  NEXTAUTH_URL: process.env.NEXTAUTH_URL,\n  PASSWORD_PEPPER: process.env.PASSWORD_PEPPER,\n  CONTACT_ALLOWED_ORIGIN: process.env.CONTACT_ALLOWED_ORIGIN,\n  SITE_BASE_URL: process.env.SITE_BASE_URL,\n});\n\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,YAAY,uMAAC,CAAC,MAAM,CAAC;IACzB,gBAAgB,uMAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAClC,qBAAqB,uMAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACvC,gBAAgB,uMAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAClC,yBAAyB,uMAAC,CACvB,MAAM,GACN,KAAK,CAAC;IACT,oBAAoB,uMAAC,CAClB,MAAM,GACN,KAAK,CAAC;IACT,iBAAiB,uMAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACnC,cAAc,uMAAC,CAAC,MAAM,GAAG,QAAQ;IACjC,iBAAiB,uMAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACnC,wBAAwB,uMAAC,CAAC,MAAM,GAAG,OAAO,CAAC;IAC3C,eAAe,uMAAC,CACb,MAAM,GACN,GAAG,CAAC,qCACJ,OAAO,CAAC;AACb;AAIO,MAAM,MAAW,UAAU,KAAK,CAAC;IACtC,gBAAgB,QAAQ,GAAG,CAAC,cAAc;IAC1C,qBAAqB,QAAQ,GAAG,CAAC,mBAAmB;IACpD,gBAAgB,QAAQ,GAAG,CAAC,cAAc;IAC1C,yBAAyB,QAAQ,GAAG,CAAC,uBAAuB;IAC5D,oBAAoB,QAAQ,GAAG,CAAC,kBAAkB;IAClD,iBAAiB,QAAQ,GAAG,CAAC,eAAe;IAC5C,cAAc,QAAQ,GAAG,CAAC,YAAY;IACtC,iBAAiB,QAAQ,GAAG,CAAC,eAAe;IAC5C,wBAAwB,QAAQ,GAAG,CAAC,sBAAsB;IAC1D,eAAe,QAAQ,GAAG,CAAC,aAAa;AAC1C"}},
    {"offset": {"line": 140, "column": 0}, "map": {"version":3,"sources":["file:///Users/macbookpro/Documents/Personal%20Works/Vibe%20Coding/Antigravity/R%26F%20City/admin-portal/src/lib/instantdb.ts"],"sourcesContent":["import { init, id } from \"@instantdb/admin\";\nimport { env } from \"@/lib/env\";\nimport {\n  AdminUserRecord,\n  ContactInput,\n  ContactRecord,\n  ContentBlock,\n  UserRole,\n  UserStatus,\n} from \"@/lib/types\";\n\nconst db = init({\n  appId: env.INSTANT_APP_ID,\n  adminToken: env.INSTANT_ADMIN_TOKEN,\n});\n\nconst CONTACTS_PAGE_SIZE = 50;\n\nexport async function insertContact(\n  payload: ContactInput,\n): Promise<ContactRecord> {\n  const contactId = id();\n  const createdAt = new Date().toISOString();\n\n  await db.transact(\n    db.tx.contacts[contactId].update({\n      fullName: payload.fullName,\n      email: payload.email,\n      phone: payload.phone ?? \"\",\n      message: payload.message ?? \"\",\n      createdAt,\n    }),\n  );\n\n  return {\n    ...payload,\n    phone: payload.phone ?? \"\",\n    message: payload.message ?? \"\",\n    id: contactId,\n    createdAt,\n  };\n}\n\nexport async function listContacts(): Promise<ContactRecord[]> {\n  const result = await db.query({\n    contacts: {\n      $: {\n        order: { createdAt: \"desc\" },\n        limit: CONTACTS_PAGE_SIZE,\n      },\n    },\n  });\n\n  return (result.contacts as ContactRecord[]) ?? [];\n}\n\nexport async function listUsers(): Promise<AdminUserRecord[]> {\n  const result = await db.query({\n    users: {\n      $: {\n        order: { createdAt: \"desc\" },\n        limit: 200,\n      },\n    },\n  });\n\n  return (result.users as AdminUserRecord[]) ?? [];\n}\n\nexport async function getUserByEmail(\n  email: string,\n): Promise<AdminUserRecord | null> {\n  const result = await db.query({\n    users: {\n      $: {\n        where: { email: email.toLowerCase() },\n        limit: 1,\n      },\n    },\n  });\n\n  const [user] = (result.users as AdminUserRecord[]) ?? [];\n  return user ?? null;\n}\n\nexport async function getUserById(\n  userId: string,\n): Promise<AdminUserRecord | null> {\n  const result = await db.query({\n    users: {\n      $: {\n        where: { id: userId },\n        limit: 1,\n      },\n    },\n  });\n  const [user] = (result.users as AdminUserRecord[]) ?? [];\n  return user ?? null;\n}\n\ntype UserCreatePayload = {\n  email: string;\n  passwordHash: string;\n  role: UserRole;\n  status: UserStatus;\n};\n\nexport async function createUser(\n  payload: UserCreatePayload,\n): Promise<AdminUserRecord> {\n  const userId = id();\n  const createdAt = new Date().toISOString();\n\n  await db.transact(\n    db.tx.users[userId].update({\n      email: payload.email.toLowerCase(),\n      passwordHash: payload.passwordHash,\n      role: payload.role,\n      status: payload.status,\n      createdAt,\n    }),\n  );\n\n  return {\n    ...payload,\n    email: payload.email.toLowerCase(),\n    createdAt,\n    id: userId,\n  };\n}\n\nexport async function updateUser(\n  userId: string,\n  updates: Partial<Pick<AdminUserRecord, \"role\" | \"status\" | \"passwordHash\">>,\n): Promise<void> {\n  await db.transact(\n    db.tx.users[userId].update({\n      ...(updates.role ? { role: updates.role } : {}),\n      ...(updates.status ? { status: updates.status } : {}),\n      ...(updates.passwordHash ? { passwordHash: updates.passwordHash } : {}),\n    }),\n  );\n}\n\nexport async function archiveUser(userId: string): Promise<void> {\n  await db.transact(\n    db.tx.users[userId].update({\n      status: \"disabled\",\n    }),\n  );\n}\n\nexport async function listContentBlocks(): Promise<ContentBlock[]> {\n  const result = await db.query({\n    content_blocks: {\n      $: {\n        order: { updatedAt: \"desc\" },\n        limit: 100,\n      },\n    },\n  });\n\n  return (result.content_blocks as ContentBlock[]) ?? [];\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 294, "column": 0}, "map": {"version":3,"sources":["file:///Users/macbookpro/Documents/Personal%20Works/Vibe%20Coding/Antigravity/R%26F%20City/admin-portal/src/lib/auth.ts"],"sourcesContent":["import type { NextAuthOptions } from \"next-auth\";\nimport Credentials from \"next-auth/providers/credentials\";\nimport { compare } from \"bcryptjs\";\nimport { env } from \"@/lib/env\";\nimport { getUserByEmail } from \"@/lib/instantdb\";\n\ntype AuthUser = {\n  id: string;\n  email: string;\n  role: string;\n  status: string;\n};\n\nexport const authOptions: NextAuthOptions = {\n  session: {\n    strategy: \"jwt\",\n  },\n  providers: [\n    Credentials({\n      name: \"Credentials\",\n      credentials: {\n        email: { label: \"Email\", type: \"email\" },\n        password: { label: \"Password\", type: \"password\" },\n      },\n      async authorize(credentials) {\n        if (!credentials?.email || !credentials?.password) {\n          return null;\n        }\n\n        const user = await getUserByEmail(credentials.email);\n        if (!user || user.status === \"disabled\") {\n          return null;\n        }\n\n        const isValid = await compare(\n          `${credentials.password}${env.PASSWORD_PEPPER}`,\n          user.passwordHash,\n        );\n\n        if (!isValid) {\n          return null;\n        }\n\n        return {\n          id: user.id,\n          email: user.email,\n          role: user.role,\n          status: user.status,\n        };\n      },\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user }) {\n      if (user) {\n        const typed = user as AuthUser;\n        token.id = typed.id;\n        token.role = typed.role;\n        token.status = typed.status;\n      }\n      return token;\n    },\n    async session({ session, token }) {\n      if (session.user) {\n        session.user.id = (token.id as string) ?? \"\";\n        session.user.role = (token.role as string) ?? \"viewer\";\n        session.user.status = (token.status as string) ?? \"invited\";\n      }\n      return session;\n    },\n  },\n  pages: {\n    signIn: \"/login\",\n  },\n  secret: env.NEXTAUTH_SECRET,\n};\n\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;;;;;AASO,MAAM,cAA+B;IAC1C,SAAS;QACP,UAAU;IACZ;IACA,WAAW;QACT,IAAA,wLAAW,EAAC;YACV,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,SAAS,CAAC,aAAa,UAAU;oBACjD,OAAO;gBACT;gBAEA,MAAM,OAAO,MAAM,IAAA,8JAAc,EAAC,YAAY,KAAK;gBACnD,IAAI,CAAC,QAAQ,KAAK,MAAM,KAAK,YAAY;oBACvC,OAAO;gBACT;gBAEA,MAAM,UAAU,MAAM,IAAA,iKAAO,EAC3B,GAAG,YAAY,QAAQ,GAAG,6IAAG,CAAC,eAAe,EAAE,EAC/C,KAAK,YAAY;gBAGnB,IAAI,CAAC,SAAS;oBACZ,OAAO;gBACT;gBAEA,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;oBACf,QAAQ,KAAK,MAAM;gBACrB;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,QAAQ;gBACd,MAAM,EAAE,GAAG,MAAM,EAAE;gBACnB,MAAM,IAAI,GAAG,MAAM,IAAI;gBACvB,MAAM,MAAM,GAAG,MAAM,MAAM;YAC7B;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;gBAChB,QAAQ,IAAI,CAAC,EAAE,GAAG,AAAC,MAAM,EAAE,IAAe;gBAC1C,QAAQ,IAAI,CAAC,IAAI,GAAG,AAAC,MAAM,IAAI,IAAe;gBAC9C,QAAQ,IAAI,CAAC,MAAM,GAAG,AAAC,MAAM,MAAM,IAAe;YACpD;YACA,OAAO;QACT;IACF;IACA,OAAO;QACL,QAAQ;IACV;IACA,QAAQ,6IAAG,CAAC,eAAe;AAC7B"}},
    {"offset": {"line": 372, "column": 0}, "map": {"version":3,"sources":["file:///Users/macbookpro/Documents/Personal%20Works/Vibe%20Coding/Antigravity/R%26F%20City/admin-portal/src/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth from \"next-auth\";\nimport { authOptions } from \"@/lib/auth\";\n\nconst handler = NextAuth(authOptions);\n\nexport { handler as GET, handler as POST };\n\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,MAAM,UAAU,IAAA,qKAAQ,EAAC,sJAAW"}}]
}